<!DOCTYPE html>
<html lang="en">
<head>
        <title>Running amazonmp3 downloader on Ubuntu 9.04 amd64 (Jaunty) via a chroot</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="./theme/css/main.css" />
</head>
<body>

    <div class="navigation pure-menu pure-menu-horizontal">
        <a href="./" class="pure-menu-heading  pure-menu-link">Slacy's Blog</a>
        <ul class="pure-menu-list">
            <li class="pure-menu-item"></li>

        </ul>
    </div>


<div class="page-container">
    <div class="entry-content">
        <div class="post-meta pure-g">
<div class="pure-u-3-4 meta-data">
    <a href="./category/general.html" class="category">General</a><br />

    <a class="author" href="./author/slacy.html">slacy</a>
    &mdash; <abbr title="2009-08-13T13:22:00-07:00">Thu 13 August 2009</abbr>
</div>        </div>
    </div>

    <div class="article-header-container">
        <div class="background-image-container">

            <div class="background-image-small">
                <div class="title-container">
                    <h1>Running amazonmp3 downloader on Ubuntu 9.04 amd64 (Jaunty) via a&nbsp;chroot</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="entry-content">
        <p>The one biggest (and most annoying) missing package for Ubuntu 9.04
amd64 is the amazon mp3 downloader package.  This is <strong>critical</strong> being
able to download special cheap albums from amazon, and is only available
as a 32-bit package for Ubuntu 8.04&nbsp;(Intrepid).</p>
<p>There are several descriptions on the net on how to hack around missing
library dependencies and download them (via getlibs) or to tweak out the
pkgconfig file to shoe horn the amazonmp3.deb file into an amd64&nbsp;system.</p>
<p>I like to keep my installs really pristine, and avoid workarounds like
getlibs and modified packages, so I&#8217;ve decided to go with a 32-bit
chroot for running amazonmp3.  Generally, the process involves
downloading another version of Ubuntu (in our case, 8.04, which is what
the amazonmp3 package was built against), and then chroot-ing into this
install area to run the 32-bit program.  Several existing tools make
this easier than it&nbsp;sounds.</p>
<h2>Get&nbsp;Ready</h2>
<p>There are several dependent packages that you should install first.  In
your base system, please&nbsp;run:</p>
<blockquote>
<p>\$ sudo apt-get install debootstrap&nbsp;schroot</p>
</blockquote>
<h2>Install 32-bit Intrepid into a&nbsp;subdirectory</h2>
<p>Using the new debootstrap package that you just installed, you can now&nbsp;run:</p>
<blockquote>
<p>\$ mkdir&nbsp;\~/chroots</p>
<p>\$ sudo debootstrap &#8212;arch=i386 intrepid&nbsp;\~/chroots/intrepid-32</p>
</blockquote>
<p>The second command will take a while to run, and will download several
hundred <span class="caps">MB</span> of intrepid packages, and install them under the newly
created directory&nbsp;\~/chroots/intrepid-32</p>
<h2>Edit&nbsp;/etc/schroot/schroot.conf</h2>
<p>You should add a section to /etc/schroot/schroot.conf that looks like&nbsp;this:</p>
<blockquote>
<p>[intrepid-32]<br>
type=directory<br>
description=Intrepid 32-bit<br>
location=/home/YOUR_USERNAME/chroots/intrepid-32<br>
priority=3<br>
users=YOUR_USERNAME,root<br>
groups=YOUR_USERNAME,root<br>
root-groups=root,adm<br>
run-setup-scripts=true<br>
run-exec-scripts=true<br>&nbsp;personality=linux32</p>
</blockquote>
<h2>Do a little bit of post-install&nbsp;cleanup.</h2>
<p>I&#8217;ve found that by default, I don&#8217;t have sudo permissions inside the
chroot, so I do this one small&nbsp;step:</p>
<blockquote>
<p>\$ sudo cp /etc/sudoers&nbsp;\~/chroots/intrepid-32/etc/sudoers</p>
</blockquote>
<p>That way, when I enter the chroot, I have sudo permissions available as&nbsp;well.</p>
<h2>Get inside the chroot and make sure it&nbsp;works</h2>
<p>You can now go inside the chroot via the following&nbsp;command:</p>
<blockquote>
<p>\$ schroot -c&nbsp;intrepid-32</p>
</blockquote>
<p>You should see that while inside the chroot, your prompt should start
with &#8220;(intrepid-32)&#8221; indicating that you&#8217;re chrooted.  Great.  Give a
simple sudo command a try to make sure it works, like&nbsp;this:</p>
<blockquote>
<p>\$ sudo ls&nbsp;\~</p>
</blockquote>
<p>Type your password, and confirm that you can run things as&nbsp;root.</p>
<p>At this point, you can do anything else you want in the chroot, like
installing other packages, or cleaning things up.  You may want to run
&#8220;sudo apt-get update ; sudo apt-get dist-upgrade&#8221; just for&nbsp;fun.</p>
<h2>Install amazonmp3.deb in the&nbsp;chroot</h2>
<p>The chroot shares your home directory, /tmp, and several other
directories with your main system (so be careful!).  But, this also
makes life easier.  While you&#8217;re outside of the chroot, download
amazonmp3.deb and put it in /tmp or your home directory. Then, get
inside the chroot, and&nbsp;run:</p>
<blockquote>
<p>(intrepid-32)\$ sudo dpkg -i&nbsp;amazonmp3.deb</p>
</blockquote>
<p>It will complain about some missing dependencies.  Install those
libraries via apt-get, and then run the dpkg -i again, and you should be
in business.  To run amazonmp3, you may need to double-check your
<span class="caps">DISPLAY</span> environment variable and make sure that it&#8217;s properly set inside
the chroot.  Once you&#8217;ve done that, you should be able to easily run
amazonmp3 inside the chroot, and download music to your home&nbsp;directory.</p>
<p>Good&nbsp;luck!</p>
    </div>

    <footer>
        <div class="tags">
            <a href="./tag/amazon-mp3.html">amazon mp3</a>
            <a href="./tag/amazonmp3.html">amazonmp3</a>
            <a href="./tag/chroot.html">chroot</a>
            <a href="./tag/intrepid.html">intrepid</a>
            <a href="./tag/jaunty.html">jaunty</a>
            <a href="./tag/mp3.html">mp3</a>
            <a href="./tag/music.html">Music</a>
            <a href="./tag/schroot.html">schroot</a>
            <a href="./tag/ubuntu.html">ubuntu</a>
        </div>
        <div class="pure-g post-footer">
            <div class="pure-u-1 pure-u-md-1-2">
                <div class="pure-g poster-info">
                    <div class="pure-u">
                        <a href="./author/slacy.html"><img src="https://slacy.github.io/blog/images/ygg.png" alt=""></a>
                    </div>
                    <div class="pure-u-3-4">
                        <h3 class="author-name"><a href="./author/slacy.html">slacy</a></h3>
                        <p class="author-description">
                                              
                        </p>
                    </div>
                </div>
            </div>



        </div>


    </footer>


</div>



    <footer class="index-footer">

        <a href="./" title="Slacy's Blog">Slacy's Blog</a>

    </footer>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85612-4', 'auto');
      ga('send', 'pageview');

    </script>
</body>
</html>