<!DOCTYPE html>
<html lang="en">
<head>
        <title>Throttling pipes in ubuntu linux using cstream</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="./theme/css/main.css" />
</head>
<body>

    <div class="navigation pure-menu pure-menu-horizontal">
        <a href="./" class="pure-menu-heading  pure-menu-link">Slacy's Blog</a>
        <ul class="pure-menu-list">
            <li class="pure-menu-item"></li>

        </ul>
    </div>


<div class="page-container">
    <div class="entry-content">
        <div class="post-meta pure-g">
<div class="pure-u-3-4 meta-data">
    <a href="./category/general.html" class="category">General</a><br />

    <a class="author" href="./author/slacy.html">slacy</a>
    &mdash; <abbr title="2009-08-24T13:06:00-07:00">Mon 24 August 2009</abbr>
</div>        </div>
    </div>

    <div class="article-header-container">
        <div class="background-image-container">

            <div class="background-image-small">
                <div class="title-container">
                    <h1>Throttling pipes in ubuntu linux using&nbsp;cstream</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="entry-content">
        <p>When I stream music from my home to my work, I want to make sure that I
throttle my music such that it doesn&#8217;t saturate my outgoing network
connection and make the rest of my internet&nbsp;slow.</p>
<p>All I wanted to do was throttle a stdout pipe that&#8217;s being sent to the
music player.  I found reference to a utility called
<a href="http://klicman.org/throttle/">throttle</a>, but also found that it isn&#8217;t
included in the Ubuntu 9.04&nbsp;distribution.</p>
<p>There&#8217;s a maliing list post that says that the program cstream will do
the same&nbsp;thing.</p>
<p>man cstream&nbsp;says:</p>
<blockquote>
<p>-t num    Limit the throughput of the data stream to num bytes/second.
Limiting is done at the input side, you can rely on cstream not
accepting more than this rate. If the number you give is positive,
cstream accumulates errors and tries to keep the overall rate at the
specified value, for the whole session. If you give a negative number,
it is an upper limit for each read/write system call pair. In other
words: the negative number will never exceed that limit, the positive
number will exceed it to make good for previous&nbsp;underutilization.</p>
</blockquote>
<p>So, I changed my audio transcoding script to&nbsp;say:</p>
<blockquote>
<p>lame &#8212;quiet -V6 \$<span class="caps">FILE</span> - | cstream -t&nbsp;25000</p>
</blockquote>
<p>The number &#8220;25000&#8221; comes from the fact that I don&#8217;t want to use more
than 192kbps of my outbound stream, and cstream&#8217;s argument is in bytes
per second.  192kbps = 24000 bytes/second, and I added a little extra. 
It would probably be safer if I also passed &#8220;-B 192&#8221; to lame, but that
would actually limit my overall quality, so I&#8217;m just going to cross my
fingers and hope that &#8220;-V6&#8221; doesn&#8217;t produce &gt;192kbps for very&nbsp;long.</p>
    </div>

    <footer>
        <div class="tags">
            <a href="./tag/cstream.html">cstream</a>
            <a href="./tag/linux.html">linux</a>
            <a href="./tag/pipe.html">pipe</a>
            <a href="./tag/throttle.html">throttle</a>
            <a href="./tag/throttling.html">throttling</a>
            <a href="./tag/ubuntu.html">ubuntu</a>
        </div>
        <div class="pure-g post-footer">
            <div class="pure-u-1 pure-u-md-1-2">
                <div class="pure-g poster-info">
                    <div class="pure-u">
                        <a href="./author/slacy.html"><img src="https://slacy.github.io/blog/images/ygg.png" alt=""></a>
                    </div>
                    <div class="pure-u-3-4">
                        <h3 class="author-name"><a href="./author/slacy.html">slacy</a></h3>
                        <p class="author-description">
                                              
                        </p>
                    </div>
                </div>
            </div>



        </div>


    </footer>


</div>



    <footer class="index-footer">

        <a href="./" title="Slacy's Blog">Slacy's Blog</a>

    </footer>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85612-4', 'auto');
      ga('send', 'pageview');

    </script>
</body>
</html>